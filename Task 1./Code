import time
users = {}  
def register():
    print("\nğŸ” User Registration:")
    username = input("Enter a new username: ").lower()
    if username in users:
        print("âŒ Username already exists. Try logging in.")
        return
    pin = input("Create a 4-digit PIN: ")
    if len(pin) != 4 or not pin.isdigit():
        print("âŒ PIN must be a 4-digit number.")
        return
    try:
        balance = float(input("Enter initial deposit amount: â‚¹"))
        if balance < 0:
            print("âŒ Balance cannot be negative.")
            return
    except ValueError:
        print("âŒ Please enter a valid amount.")
        return
    users[username] = [pin, balance, []]
    print(f"âœ… User '{username}' registered successfully!")

def login():
    print("\nğŸ”‘ Login:")
    username = input("Enter your username: ").lower()
    if username not in users:
        print("âŒ User not found. Please register first.")
        return None
    for attempt in range(3):
        pin = input("Enter your 4-digit PIN: ")
        if pin == users[username][0]:
            print("âœ… Login successful!")
            return username
        else:
            print("âŒ Incorrect PIN.")
    print("âŒ Too many failed attempts. Try again later.")
    return None

def show_menu():
    print("\n====== ATM MENU ======")
    print("1. Check Balance")
    print("2. Deposit")
    print("3. Withdraw")
    print("4. Transaction History")
    print("5. Logout")

def check_balance(username):
    print(f"ğŸ’° Your current balance is â‚¹{users[username][1]:.2f}")

def deposit(username):
    try:
        amount = float(input("Enter amount to deposit: â‚¹"))
        if amount > 0:
            users[username][1] += amount
            users[username][2].append(f"Deposited â‚¹{amount:.2f}")
            print(f"âœ… â‚¹{amount:.2f} deposited successfully.")
        else:
            print("âŒ Enter a positive amount.")
    except ValueError:
        print("âŒ Invalid amount.")

def withdraw(username):
    try:
        amount = float(input("Enter amount to withdraw: â‚¹"))
        if amount > 0:
            if amount <= users[username][1]:
                users[username][1] -= amount
                users[username][2].append(f"Withdrew â‚¹{amount:.2f}")
                print(f"âœ… â‚¹{amount:.2f} withdrawn successfully.")
            else:
                print("âŒ Insufficient balance.")
        else:
            print("âŒ Enter a positive amount.")
    except ValueError:
        print("âŒ Invalid amount.")

def transaction_history(username):
    print("\nğŸ“œ Transaction History:")
    history = users[username][2]
    if history:
        for item in history:
            print("â€¢", item)
    else:
        print("No transactions yet.")

def atm_system():
    while True:
        print("\n====== WELCOME TO PYTHON ATM ======")
        print("1. Register")
        print("2. Login")
        print("3. Exit")
        choice = input("Choose an option (1-3): ")
        
        if choice == '1':
            register()
        elif choice == '2':
            username = login()
            if username:
                while True:
                    show_menu()
                    option = input("Select an option (1-5): ")
                    if option == '1':
                        check_balance(username)
                    elif option == '2':
                        deposit(username)
                    elif option == '3':
                        withdraw(username)
                    elif option == '4':
                        transaction_history(username)
                    elif option == '5':
                        print("ğŸ”’ Logged out.")
                        break
                    else:
                        print("âŒ Invalid option.")
                    time.sleep(1.5)
        elif choice == '3':
            print("ğŸ‘‹ Thank you for using Python ATM. Goodbye!")
            break
        else:
            print("âŒ Invalid choice.")
atm_system()
